[project]
name = "aide-codium-extension"
version = "0.1.0"
channels = ["https://software.repos.intel.com/python/conda", "conda-forge"]
platforms = ["linux-64"]

[dependencies]
python = "3.11.*"
# Intel PyTorch stack - keep these in conda
pytorch = "*"
intel-extension-for-pytorch = "*"
# Move problematic packages to conda to avoid PyPI conflicts
numpy = "*"
scipy = "*"
transformers = "*"  # MOVE THIS TO CONDA
accelerate = "*"    # MOVE THIS TO CONDA
# Keep other dependencies as-is
ffmpeg = "*"
qdrant-client = "*"
pypdf2 = "*"
python-docx = "*"
tesseract = "*"
pytesseract = "*"
pdf2image = "*"
ebooklib = "*"
markdown = "*"
requests = "*"
tokenizers = "*"
pysoundfile = "*"
librosa = "*"
pyaudio = "*"
fastapi = "*"
uvicorn = ">=0.35.0,<0.36"
websockets = "*"
pydantic = "*"
watchdog = "*"
gitpython = "*"
tqdm = "*"
click = "*"
rich = "*"
webrtcvad = "*"
llama-cpp-python = "*"
ctransformers = "*"
bitsandbytes = "*"
chromadb = "*"
dpcpp_cpp_rt = "*"
"ruamel.yaml" = "*"

[pypi-dependencies]
openai-whisper = "*"
vosk = "*"
coqui-tts = "*"
google-api-python-client = "*"
serpapi = "*"
duckduckgo-search = "*"
sentence-transformers = "*"
loguru = "*"
# REMOVED: transformers, accelerate (moved to conda)
# REMOVED: torch, numpy, scipy (using conda versions)
pillow = "*"
mistral-common = "*"
sounddevice = ">=0.5.2, <0.6"
huggingface-hub = "*"
hf-transfer = "*"

[tasks]
setup-models = "mkdir -p models"
download-deepseek = "HF_HUB_ENABLE_HF_TRANSFER=1 huggingface-cli download huihui-ai/DeepSeek-R1-Distill-Qwen-7B-abliterated --local-dir ./models/deepseek"
download-pixtral = "HF_HUB_ENABLE_HF_TRANSFER=1 huggingface-cli download mistralai/Pixtral-12B-2409 --local-dir ./models/pixtral"
download-both = "pixi run download-deepseek && pixi run download-pixtral"
test-xpu = "python -c \"import torch; import intel_extension_for_pytorch as ipex; print(f'PyTorch: {torch.__version__}'); print(f'IPEX: {ipex.__version__}'); print(f'XPU available: {torch.xpu.is_available()}'); print(f'Device count: {torch.xpu.device_count() if torch.xpu.is_available() else 0}')\""
